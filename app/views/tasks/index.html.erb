<% content_for :title, "Tasks" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1><i class="bi bi-list-check"></i> My Tasks <span class="badge bg-success">Hot-Reload Active!</span></h1>
    <% if @tasks.any? %>
      <p class="text-muted mb-0">
        Showing <%= @pagy.from %>-<%= @pagy.to %> of <%= @pagy.count %> tasks
        <% if @pagy.pages > 1 %>
          (Page <%= @pagy.page %> of <%= @pagy.pages %>)
        <% end %>
      </p>
    <% end %>
  </div>
  <%= link_to new_task_path, class: "btn btn-primary" do %>
    <i class="bi bi-plus-lg"></i> New Task
  <% end %>
</div>

<% if @tasks.any? %>
  <div class="row">
    <% @tasks.each do |task| %>
      <div class="col-md-6 col-lg-4 mb-3">
        <div class="card h-100 <%= task.completed? ? 'border-success' : '' %>">
          <div class="card-body">
            <h5 class="card-title">
              <% if task.completed? %>
                <i class="bi bi-check-circle-fill text-success"></i>
                <del><%= task.title %></del>
              <% else %>
                <i class="bi bi-circle"></i>
                <%= task.title %>
              <% end %>
            </h5>
            <p class="card-text text-muted">
              <%= truncate(task.description, length: 100) %>
            </p>
          </div>
          <div class="card-footer bg-transparent">
            <%= link_to task, class: "btn btn-sm btn-outline-primary" do %>
              <i class="bi bi-eye"></i> View
            <% end %>
            <%= link_to edit_task_path(task), class: "btn btn-sm btn-outline-secondary" do %>
              <i class="bi bi-pencil"></i> Edit
            <% end %>
            <%= button_to task_path(task), method: :delete, class: "btn btn-sm btn-outline-danger",
                form: { data: { turbo_confirm: "Are you sure?" } } do %>
              <i class="bi bi-trash"></i> Delete
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <%# Pagination controls %>
  <div class="mt-4 d-flex justify-content-center">
    <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
  </div>
<% else %>
  <div class="alert alert-info" role="alert">
    <i class="bi bi-info-circle"></i> No tasks yet. Create your first task to get started!
  </div>
<% end %>
